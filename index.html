<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Valentine Wall Kenya ðŸŒ¹</title>
<style>
  body { font-family: Arial, sans-serif; background: #fff0f5; color: #333; margin:0; padding:0; }
  h1 { text-align:center; padding: 20px; color: #c71585; }
  .message-wall { display: flex; flex-direction: column; align-items:center; padding: 10px; }
  .card { background: #ffe6f2; border-radius: 12px; padding: 15px; margin:10px; width: 90%; max-width:500px; box-shadow: 0 2px 8px rgba(0,0,0,0.2);}
  .name { font-weight: bold; color:#c71585; }
  .recipient { font-style: italic; color:#8b008b; }
  .text { margin-top: 8px; }
</style>
</head>
<body>

<h1>Valentine Wall Kenya ðŸŒ¹</h1>
<div class="message-wall" id="wall">
  <p>Loading messages...</p>
</div>

<script>
  const sheetID = "1UJXtENBRZeBEbF1jaJl8MN527FK-jNlJwkfCZ8Se5Y0"; // <-- Replace this with your Sheet ID
  const gvizURL = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json`;

  fetch(gvizURL)
    .then(res => res.text())
    .then(text => {
      // Clean gviz wrapper
      const json = JSON.parse(text.substring(47).slice(0, -2));
      const rows = json.table.rows;

      const wallDiv = document.getElementById("wall");
      wallDiv.innerHTML = ""; // Clear loading text

      let count = 0;
      rows.forEach(row => {
        const approved = row.c[json.table.cols.findIndex(c=>c.label==="Approved")]?.v;
        if(approved && approved.toLowerCase() === "yes") {
          const name = row.c[json.table.cols.findIndex(c=>c.label==="Your Name")]?.v || "Someone";
          const recipient = row.c[json.table.cols.findIndex(c=>c.label==="Recipient Name")]?.v || "Valentine";
          const message = row.c[json.table.cols.findIndex(c=>c.label==="Valentine Message")]?.v || "";

          const card = document.createElement("div");
          card.className = "card";
          card.innerHTML = `
            <div class="name">${name}</div>
